# 磁盘

## 磁盘的调度算法

### 一次磁盘读写操作需要的时间

寻找时间：将磁头移动到制定磁道所花的时间。

- 启动磁头臂需要时间，移动也需要时间

延迟时间：通过旋转磁盘，是磁头定位到目标扇区所需要的时间。

传输时间：从磁盘读出或向磁盘写入数据所经历的时间。

-----

### 先来先服务算法（FCFS）

根据进程请求访问磁盘的**先后顺序**进行调度

缺点：如果所需访问的磁道很分散，效率会很低

### 最短寻找时间优先（SSTF)

优先处理与当前磁头最近的磁道。可以保证每次的寻道时间最短（贪心）但无法保证总的时间最短。

优点：平均寻找长度和寻道时间会降低

缺点：会产生饥饿

### 扫描算法（SCAN)

为了解决sstf的饥饿问题，我们可以规定，只有磁头移动到最外侧的磁道的时候才能往内移动，移动到最内侧的磁道时才能往外移动，就可以遍历整个磁盘的所有磁道，解决饥饿问题。**类比：风扇摇头**

缺点：

- 只有在最边上的磁道才能改变磁头移动的防线，会浪费时间。
- 对于每个位置磁道的相应频率不平均，比如说风扇摇头，摇到中间的时间间隔是一样的，但是越靠近两边，所间隔的时间就越不平均。

### LOOK调度算法

在扫描算法的基础上，如果当前移动方向上已经没有别的请求了，可以立即掉头，不需要走到最外侧或最内侧。

### 循环扫描算法（C-SCAN）

向日葵算法，在SCAN的基础上：从东扫描到西边，然后猛甩头，再从东边走到西边，循环往复。

### C-LOOK调度算法

C-SCAN的基础上,如果磁头移动的方向上已经没有磁道访问请求了，**直接猛甩头**。

---



## 减少磁盘延迟时间的方法

### 交替编号

让逻辑上相邻的扇区在物理上有一定的间隔，因为磁头读完一个扇区之后要准备一下，如果逻辑上的两个扇区挨着的，磁头就会错过下一个扇区，那么就要转一圈再回来读。

### 错位命名

不同盘面之间的命名错开一位，这样可以方便不同盘面之间的连续读取。

###  **磁盘的物理地址：**

柱面号（词道号），盘面号，扇区号

而不是（盘面号、柱面号、扇区号）

原则：尽量减少移动磁头的次数。

由于柱面号和磁道号相同，当出现磁盘号不同的情况，只需要激活相邻盘面的磁头即可，而不需要移动磁头臂 。

### 磁盘初始化

Step1：低级格式化（物理格式化），将磁盘的各个磁道划分为扇区。

Step2：将磁盘分区，每个分区由若干柱面组成。

Step3：进行逻辑格式化，创建文件系统。

### 磁盘引导块

计算机启动时需要运行初始化程序（自居程序）来完成初始化。

初始化程序可以放在ROM中，ROM中的数据在出厂时就写入了，并且以后不能再修改。

### 坏块的管理

坏块属于硬件故障，操作系统无法修复，应该将其标记出来，一面错误的使用到。



